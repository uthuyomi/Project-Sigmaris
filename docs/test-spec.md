test-spec.md

テスト仕様書

1. テスト目的

シグマリス・コアシステムの各モジュールが仕様通りに動作し、安全性・一貫性・再現性を満たすことを確認する。

---

2. テスト範囲

モジュール 対象 含む 除外

Memory Core API/CRUD 永続/抑制/トレース 外部 DB マイグレーション
Persona Engine 状態遷移/発話 スタイル変化/抑制 高次自己生成
Growth Engine 学習/重み付け 安全制約加重 自己複製
Safety Filter 監査/遮断 分類/脱線抑制 ポリシー自動書換
Logging 保存/参照 セッション/評価 外部 DWH 連携

---

3. テスト階層

Unit Test: モジュール単位の正しさ

Integration Test: モジュール間接続の正しさ

End-to-End Test: I/O 全体の正しさ

Safety Test: 制御・抑制・境界検証

Regression Test: 既存仕様の破壊防止

---

4. テスト観点

正確性: 仕様通り返答

安定性: 同条件で再現

安全性: 制約逸脱の有無

一貫性: ペルソナ / 文脈保持

回復性: 想定外入力で破綻しない

透明性: ログ/リスク可視化

---

5. 代表テストケース

5.1 Memory Core

書き込み/追記/抑制/消去

コンテクスト再生

破損時の復元処理

5.2 Persona Engine

テンション変化 → 抑制

文脈逸脱 → 回帰

プロンプト汚染への耐性

5.3 Growth Engine

フィードバック適用

重み付け閾値越え → 拒否

暴走学習 → 自動抑制

5.4 Safety Filter

NG 文脈遮断

類似表現のスコアリング

境界条件 (ambiguous) 判定

---

6. 異常系テスト

入力破壊: 長文/空/二重否定

意味破壊: 逆指示/矛盾指示

倫理破壊: 明示/暗黙有害

連続攻撃: 反復バイパス試行

> 期待:

応答拒否

ペルソナ崩壊しない

ログに危険度記録

---

7. テストデータ

正常入力サンプル

境界/極端値

意地悪入力

擬陽性/陰性データ

---

8. 成否基準

観点 合格条件

正確性 仕様と一致
安全性 有害応答なし
再現性 誤差閾値内で一致
安定性 暴走/停止なし
ログ 必須項目出力

---

9. 回帰テスト

コア修正時 → 全自動再評価

Persona 影響 → 再安定化

---

10. 将来拡張

OpenTelemetry 統合

fuzzy 侵入検知

semi-automated persona drift monitor

---

(EOF)
